# –ü—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–∞–∑–∞ –æ—Ç ViewComponent –≤ –ø–æ–ª—å–∑—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö Spree partials

## üö´ –ü—Ä–æ–±–ª–µ–º—ã —Å ViewComponent + Spree –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

### 1. **–°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º Spree helpers**

#### –ü—Ä–æ–±–ª–µ–º–∞
- **–û—à–∏–±–∫–∞:** `undefined local variable or method 'try_spree_current_user'`
- **–ü—Ä–∏—á–∏–Ω–∞:** ViewComponent –≤ —Ç–µ—Å—Ç–∞—Ö –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Spree helpers –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **–ü–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è:**
  ```ruby
  # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - view –æ–±—ä–µ–∫—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  view.extend(Spree::StorefrontHelper)
  
  # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - ActionView::Base –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ç–æ–¥
  allow_any_instance_of(ActionView::Base).to receive(:try_spree_current_user)
  
  # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - vc_test_controller –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω
  vc_test_controller.view_context.extend(Spree::BaseHelper)
  ```

#### –†–µ–∑—É–ª—å—Ç–∞—Ç
- **16 –ø—Ä–æ–≤–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å helpers
- **–í—Ä–µ–º—è –ø–æ—Ç—Ä–∞—á–µ–Ω–æ:** ~4 —á–∞—Å–∞ –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ViewComponent

### 2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä ViewComponent vs Spree**

#### ViewComponent —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç Rails helpers
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### Spree —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è  
- –¢—è–∂–µ–ª–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç helpers (try_spree_current_user, show_account_pane?, current_store)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Rails view system –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ RSpec view specs

#### –ö–æ–Ω—Ñ–ª–∏–∫—Ç
ViewComponent —Ç—Ä–µ–±—É–µ—Ç **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞–∂–¥—ã–º Spree helper, —á—Ç–æ **—É—Å–ª–æ–∂–Ω—è–µ—Ç** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤–º–µ—Å—Ç–æ —É–ø—Ä–æ—â–µ–Ω–∏—è.

### 3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

#### –ß—Ç–æ –ø—Ä–æ–±–æ–≤–∞–ª–∏
1. **spec_helper.rb** - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è Rails-–∑–∞–≤–∏—Å–∏–º—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
2. **rails_helper.rb** - ViewComponent helpers –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å Spree
3. **database_cleaner** - –¥–æ–±–∞–≤–∏–ª–∏, –Ω–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å
4. **decorator_loader.rb** - —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤, –Ω–æ –Ω–µ ViewComponent

#### –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `FactoryBot` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ spec_helper.rb (–Ω—É–∂–µ–Ω Rails)
- ViewComponent TestHelpers –Ω–µ –ø–æ–¥–∫–ª—é—á–∞—é—Ç Spree helpers –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ **–ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤—ã–≥–æ–¥—ã** –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ViewComponent

### 4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ clear benefit**

#### ViewComponent –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ)
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å

#### ViewComponent –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ)
- ‚ùå **–°–ª–æ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Spree**
- ‚ùå **–ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º helpers**
- ‚ùå **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**
- ‚ùå **–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**

#### –ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
**–£—Å–∏–ª–∏—è –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é >> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Spree –ø–æ–¥—Ö–æ–¥–∞

### 1. **–ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```ruby
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π RSpec view spec - —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
RSpec.describe "spree/shared/_navbar", type: :view do
  it "renders navbar" do
    render partial: "spree/shared/navbar", locals: { section: header_section }
    expect(rendered).to include('navbar-storefront')
  end
end
```

### 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Spree –∏–∑ –∫–æ—Ä–æ–±–∫–∏**
- –í—Å–µ Spree helpers –¥–æ—Å—Ç—É–ø–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –°–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º Spree

### 3. **–ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
- –£–±–∏—Ä–∞–µ–º ViewComponent gem
- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Rails partials
- –°–ª–µ–¥—É–µ–º –ø—Ä–∏–Ω—Ü–∏–ø—É KISS (Keep It Simple, Stupid)

### 4. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Spree**
- Spree –∏—Å–ø–æ–ª—å–∑—É–µ—Ç partials –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏
- Themes —Ä–∞–±–æ—Ç–∞—é—Ç —Å partials, –Ω–µ —Å ViewComponent
- –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã + partials = —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Spree –ø–∞—Ç—Ç–µ—Ä–Ω

## üéØ –†–µ—à–µ–Ω–∏–µ: –í–æ–∑–≤—Ä–∞—Ç –∫ Spree partials

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. **–£–¥–∞–ª—è–µ–º ViewComponent**
```bash
# –£–¥–∞–ª—è–µ–º —Ñ–∞–π–ª—ã
rm -rf app/components/navbar/
rm -rf spec/components/navbar/

# –£–±–∏—Ä–∞–µ–º –∏–∑ Gemfile
# gem "view_component"
```

#### 2. **–°–æ–∑–¥–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ partials**
```
app/views/themes/modern_animated_navbar/spree/
‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îî‚îÄ‚îÄ _navbar.html.slim
‚îî‚îÄ‚îÄ page_sections/
    ‚îî‚îÄ‚îÄ _header.html.slim  # render partial: 'shared/navbar'
```

#### 3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```
spec/
‚îú‚îÄ‚îÄ views/spree/shared/
‚îÇ   ‚îî‚îÄ‚îÄ _navbar.html.slim_spec.rb
‚îî‚îÄ‚îÄ features/
    ‚îî‚îÄ‚îÄ navbar_spec.rb
```

#### 4. **–û–±–Ω–æ–≤–ª—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
- TODO.md - —É–±–∏—Ä–∞–µ–º ViewComponent –∑–∞–¥–∞—á–∏
- README.md - –æ–ø–∏—Å—ã–≤–∞–µ–º partial-based –ø–æ–¥—Ö–æ–¥
- NavBarIntegrationToSpreeStorefront.md - –æ–±–Ω–æ–≤–ª—è–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | ViewComponent | Spree Partials |
|----------|---------------|----------------|
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | ‚ùå –í—ã—Å–æ–∫–∞—è | ‚úÖ –ù–∏–∑–∫–∞—è |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Spree** | ‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | ‚úÖ –ò–∑ –∫–æ—Ä–æ–±–∫–∏ |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚ùå –°–ª–æ–∂–Ω–æ–µ | ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ** | ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç | ‚úÖ –ù–∞—Ç–∏–≤–Ω–æ |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** | ‚ùå –°–æ–æ–±—â–µ—Å—Ç–≤–æ VC | ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Spree |

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ö–æ–º–º–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏** - –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ
2. **–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** - —É–±—Ä–∞—Ç—å ViewComponent –∫–æ–¥
3. **–°–æ–∑–¥–∞–Ω–∏–µ partials** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ—Å—Ç—ã–µ view specs
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ TODO** - –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

## üí° –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏

1. **–ù–µ –≤—Å–µ–≥–¥–∞ –Ω–æ–≤–æ–µ == –ª—É—á—à–µ** - ViewComponent —Ö–æ—Ä–æ—à, –Ω–æ –Ω–µ –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
2. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–∞–∂–Ω–∞** - —Å–ª–µ–¥—É–π –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å** - KISS –ø—Ä–∏–Ω—Ü–∏–ø –≤ –¥–µ–π—Å—Ç–≤–∏–∏
4. **–í—Ä–µ–º—è –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é != —Ü–µ–Ω–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è** - ROI –∞–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–µ–Ω

**–ò—Ç–æ–≥:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Spree –ø–æ–¥—Ö–æ–¥ —Å partials –æ–∫–∞–∑–∞–ª—Å—è –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º –¥–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ navbar —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —É—Å–∏–ª–∏—è–º–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é.
